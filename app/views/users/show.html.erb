<% content_for :title, "#{@user.display_name}'s Profile" %>

<div class="max-w-4xl mx-auto">
  <div class="bg-white rounded-lg shadow-md p-8 mb-8">
    <div class="flex items-center space-x-6 mb-6">
      <div class="w-24 h-24 rounded-full overflow-hidden bg-gray-300 flex items-center justify-center">
        <% if @user.avatar.attached? %>
          <%= image_tag @user.avatar_thumbnail(200), alt: "#{@user.display_name}のアバター", class: "w-full h-full object-cover" %>
        <% else %>
          <span class="text-2xl font-bold text-gray-600"><%= @user.display_name.first.upcase %></span>
        <% end %>
      </div>
      
      <div class="flex-1">
        <h1 class="text-3xl font-bold text-gray-900 mb-2"><%= @user.display_name %></h1>
        <% if @user.bio.present? %>
          <p class="text-gray-700 mb-2"><%= @user.bio %></p>
        <% end %>
        <% if @user.website.present? %>
          <p class="text-blue-600 hover:text-blue-800">
            <%= link_to @user.website, sanitize_url(@user.website), target: "_blank", rel: "noopener" %>
          </p>
        <% end %>
      </div>
      
      <div class="flex space-x-3">
        <% if user_signed_in? && @user == current_user %>
          <%= link_to t('users.show.edit_profile'), edit_user_path(@user), class: "px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700" %>
        <% else %>
          <%= render 'shared/follow_button', user: @user %>
        <% end %>
      </div>
    </div>
    
    <div class="border-t pt-6">
      <div class="grid grid-cols-3 gap-4 text-center">
        <div>
          <p class="text-2xl font-bold text-gray-900"><%= @user.posts.published.count %></p>
          <p class="text-gray-600"><%= t('follows.posts_count') %></p>
        </div>
        <div>
          <p class="text-2xl font-bold text-gray-900"><%= @user.followers_count %></p>
          <p class="text-gray-600"><%= t('follows.followers') %></p>
        </div>
        <div>
          <p class="text-2xl font-bold text-gray-900"><%= @user.following_count %></p>
          <p class="text-gray-600"><%= t('follows.following') %></p>
        </div>
      </div>
      <div class="mt-4 text-center text-sm text-gray-500">
        <%= joined_date_in_japanese(@user.created_at) %>
      </div>
    </div>
  </div>

  <!-- User's Posts -->
  <div class="space-y-6">
    <h2 class="text-2xl font-bold text-gray-900"><%= @user.display_name %>さんの投稿</h2>
    
    <% if @posts.any? %>
      <% @posts.each do |post| %>
        <article class="bg-white rounded-lg shadow-md p-6">
          <h3 class="text-xl font-bold mb-2">
            <%= link_to post.title, post, class: "text-gray-900 hover:text-blue-600" %>
          </h3>
          <p class="text-gray-700 mb-4"><%= post.excerpt(200) %></p>
          <p class="text-sm text-gray-500">
            <%= time_ago_in_japanese(post.created_at) %>
          </p>
        </article>
      <% end %>
    <% else %>
      <div class="text-center py-12 bg-white rounded-lg shadow-md">
        <p class="text-gray-500">まだ投稿がありません。</p>
      </div>
    <% end %>
  </div>
</div>